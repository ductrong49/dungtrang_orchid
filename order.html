<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Đặt Hàng Tạm Thời - Copy Hình & Text</title>
<style>
  body { font-family: Arial; padding: 20px; background: #f9f9f9; }
  h1 { text-align: center; }
  form { background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 0 5px rgba(0,0,0,0.1); margin-bottom: 20px; }
  label { display: block; margin-top: 10px; }
  input, textarea, button { margin-top: 5px; padding: 8px; width: 100%; max-width: 500px; }
  textarea { height: 100px; }
  button.copy-btn { margin-top: 10px; cursor: pointer; background: #0b74da; color: #fff; border: none; border-radius: 5px; padding: 8px 15px; }
  #resultDiv { border: 1px solid #ccc; background: #fff; padding: 10px; min-height: 200px; border-radius: 5px; margin-top: 10px; }
  .order-block { border-bottom: 1px dashed #aaa; margin-bottom: 10px; padding-bottom: 10px; }
  .order-block img { max-width: 150px; display: block; margin-top: 5px; border-radius: 6px; }
</style>
</head>
<body>

<h1>Đặt Hàng</h1>

<form id="orderForm">
  <label>Tên khách:</label>
  <input type="text" id="customerName" required>

  <label>Địa chỉ:</label>
  <input type="text" id="address" required>

  <label>Tên hàng:</label>
  <input type="text" id="itemName" required>

  <label>Số lượng:</label>
  <input type="text" id="quantity" required>

  <label>NCC:</label>
  <input type="text" id="supplier">

  <label>Cước:</label>
  <input type="text" id="fee">

  <label>NV Sale:</label>
  <input type="text" id="sale">

  <label>Ghi chú:</label>
  <textarea id="note"></textarea>

  <label>Upload hình:</label>
  <input type="file" id="imageUpload" accept="image/*">

  <button type="submit">Thêm vào danh sách</button>
</form>

<button class="copy-btn" onclick="copyAll()">Copy toàn bộ (gồm hình)</button>

<div id="resultDiv"></div>

<script>
let imageFiles = [];

document.getElementById("orderForm").addEventListener("submit", function(e){
    e.preventDefault();

    const name = customerName.value.trim();
    const addr = address.value.trim();
    const item = itemName.value.trim();
    const qty = quantity.value.trim();
    const supplier = supplier.value.trim();
    const fee = fee.value.trim();
    const sale = sale.value.trim();
    const note = note.value.trim();
    const file = imageUpload.files[0];

    let block = document.createElement("div");
    block.className = "order-block";

    block.innerHTML = `
        <div>Tên khách: ${name}</div>
        <div>Địa chỉ: ${addr}</div>
        <div>Tên hàng: ${item}</div>
        <div>Số lượng: ${qty}</div>
        <div>NCC: ${supplier}</div>
        <div>Cước: ${fee}</div>
        <div>NV Sale: ${sale}</div>
        <div>Ghi chú: ${note}</div>
    `;

    if(file){
        const imgURL = URL.createObjectURL(file);
        let img = document.createElement("img");
        img.src = imgURL;
        block.appendChild(img);

        imageFiles.push(file); 
    }

    resultDiv.appendChild(block);

    orderForm.reset();
});

async function copyAll(){
    let textToCopy = resultDiv.innerText;

    let clipboardItems = [];

    clipboardItems.push(
        new ClipboardItem({ "text/plain": new Blob([textToCopy], { type: "text/plain" }) })
    );

    for(let file of imageFiles){
        clipboardItems.push(
            new ClipboardItem({ [file.type]: file })
        );
    }

    try {
        await navigator.clipboard.write(clipboardItems);
        alert("Đã copy text + hình. Dán vào Zalo được luôn!");
    } catch (err){
        alert("Trình duyệt không hỗ trợ copy hình. Hãy dùng Chrome hoặc Edge.");
    }
}
</script>

</body>
</html>
