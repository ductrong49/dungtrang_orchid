<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TH·ªêNG K√ä KHO H√ÄNG</title>
<style>
  body{
    font-family: Arial, sans-serif;
    margin:0;
    background:#f5faff;
    color:#222;
  }
  header{
    text-align:center;
    padding:24px 12px;
    background:linear-gradient(135deg,#4facfe,#00f2fe);
    color:white;
    font-size:28px;
    font-weight:800;
    letter-spacing:1px;
    text-shadow:0 2px 4px rgba(0,0,0,0.25);
  }
  .sub{
    text-align:center;
    font-size:16px;
    font-weight:700;
    margin:10px 0 20px;
    color:#0b57d0;
  }
  .wrap{
    max-width:1100px;
    margin:20px auto;
    padding:12px;
  }
  table{
    width:100%;
    border-collapse:collapse;
    background:white;
    border-radius:10px;
    overflow:hidden;
    box-shadow:0 4px 14px rgba(0,0,0,0.1);
  }
  th,td{
    padding:8px 10px;
    border:1px solid #e0e6f5;
    font-size:10px;
    color:#000;
  }
  /* D√≤ng 3 (B3:G3) */
  tr.row-top td{
    font-weight:bold;
    color:#0b57d0;
    background:#eaf2ff;
  }
  /* D√≤ng c√≥ gi√° tr·ªã c·ªôt G */
  tr.bold td{
    font-weight:bold;
  }
  th{
    background:#d9ecff;
    color:#003f91;
    font-size:13px;
    font-weight:700;
    border-bottom:2px solid #b6d7ff;
  }
</style>
</head>
<body>

<header>TH·ªêNG K√ä KHO H√ÄNG</header>
<div class="sub" id="tonKho">T·ªìn kho hi·ªán t·∫°i: ...</div>

<div class="wrap">
  <div id="tableWrap">ƒêang t·∫£i d·ªØ li·ªáu...</div>
</div>

<script>
  const SHEET_ID = "1p2ymdDNkIw_WXa9oFkXm4_YJG5FL1gzgwTvq_9GyOEw";
  const SHEET_NAME = "ton";
  const RANGE = "B3:G1000";

  const tableWrap = document.getElementById("tableWrap");
  const tonKhoEl = document.getElementById("tonKho");

  async function loadSheet(){
    const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${SHEET_NAME}&range=${RANGE}`;
    try{
      const res = await fetch(url);
      let text = await res.text();
      text = text.replace(/^[^\(]*\(/, '').replace(/\);?$/, '');
      const json = JSON.parse(text);
      const table = json.table;

      const cols = table.cols.map(c => c.label || "");
      const rows = table.rows.map(r => r.c.map(c => c ? c.v : ""));

      // üëâ L·∫•y D3 (t·ª©c c·ªôt D = index 2 trong B:G)
      tonKhoEl.innerHTML = `T·ªìn kho hi·ªán t·∫°i: ${rows[0][2] || ""}`;

      const html = [];
      html.push("<table><thead><tr>");
      cols.forEach(c => html.push(`<th>${c}</th>`));
      html.push("</tr></thead><tbody>");

      rows.forEach((r, i) => {
        // b·ªè d√≤ng r·ªóng
        if(r.every(c => c === "" || c === " ")) return;

        let cls = "";
        if(i === 0) cls = "row-top";        // d√≤ng 3
        if(r[5] !== "" && r[5] !== " ") cls += " bold"; // c·ªôt G

        html.push(`<tr class="${cls.trim()}">`);
        r.forEach(c => html.push(`<td>${c}</td>`));
        html.push("</tr>");
      });

      html.push("</tbody></table>");
      tableWrap.innerHTML = html.join("");
    }
    catch(e){
      tableWrap.innerHTML = "L·ªói t·∫£i d·ªØ li·ªáu ‚Äî h√£y ki·ªÉm tra quy·ªÅn chia s·∫ª Google Sheet.";
    }
  }

  loadSheet();
</script>
</body>
</html>
