<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Báo giá hoa lan - Dũng Trang</title>
<style>
  :root{
    --bg:#f3f4f6; --card:#ffffff; --accent:#0b74da; --muted:#6b7280;
  }
  body{font-family:Inter, system-ui, Arial, Helvetica, sans-serif; background:var(--bg); margin:0; padding:24px; color:#111}
  .wrap{max-width:980px; margin:0 auto; display:grid; gap:18px; grid-template-columns:1fr 420px;}
  header{grid-column:1/-1; display:flex; gap:12px; align-items:center; justify-content:center;}
  h1{margin:0; font-size:20px;}
  .card{background:var(--card); border-radius:10px; padding:14px; box-shadow:0 6px 18px rgba(12,12,12,0.06);}
  form .row{display:flex; gap:8px; margin-bottom:10px;}
  label{font-size:13px; color:var(--muted); display:block; margin-bottom:6px}
  input, select { width:100%; padding:8px 10px; border-radius:8px; border:1px solid #e5e7eb; font-size:14px; box-sizing:border-box; }
  button{background:var(--accent); color:#fff; border:none; padding:10px 14px; border-radius:8px; cursor:pointer;}
  button.secondary{background:#374151;}
  canvas{width:100%; height:auto; border-radius:8px; background:#fff; display:block;}
  .controls{display:flex; gap:8px; margin-top:8px; flex-wrap:wrap;}
  .right-col{display:flex; flex-direction:column; gap:12px;}
  .info-inline{display:flex; gap:8px;}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <h1>BÁO GIÁ - HOA LAN HỒ ĐIỆP DŨNG TRANG - ĐÀ LẠT</h1>
  </header>

  <div class="card">
    <canvas id="canvas"></canvas>
    <div class="controls">
      <button id="renderBtn">Tạo ảnh</button>
      <button id="downloadBtn" class="secondary">Tải ảnh</button>
      <button id="shareBtn" style="background:#2fa5e0;">Chia sẻ</button>
    </div>
  </div>

  <aside class="right-col">
    <div class="card">
      <h3>Thông tin sản phẩm</h3>
      <form id="dataForm" onsubmit="return false;">
        <label for="imageInput">Chọn ảnh sản phẩm</label>
        <input id="imageInput" type="file" accept="image/*" />
        <label for="productName">Tên sản phẩm</label>
        <input id="productName" type="text" placeholder="Ví dụ: Hoa lan vàng" />
        <label for="size">Kích thước</label>
        <input id="size" type="text" placeholder="Ví dụ: 30x40cm" />
        <label for="qty">Số lượng</label>
        <input id="qty" type="text" placeholder="Ví dụ: 10 cây" />
        <label for="price">Giá</label>
        <input id="price" type="text" placeholder="Ví dụ: 11x K" />
        <label for="phone">Số điện thoại</label>
        <input id="phone" type="text" value="0918.604260" />
      </form>
    </div>
  </aside>
</div>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
let img = new Image(), imgLoaded=false;

const imageInput = document.getElementById("imageInput");
const productName = document.getElementById("productName");
const sizeInput = document.getElementById("size");
const qtyInput = document.getElementById("qty");
const priceInput = document.getElementById("price");
const phoneInput = document.getElementById("phone");

imageInput.addEventListener("change", e=>{
  const file = e.target.files[0];
  if(!file) return;
  const reader = new FileReader();
  reader.onload = ev=>{
    img=new Image();
    img.onload=()=>{ imgLoaded=true; drawOverlay(); };
    img.src=ev.target.result;
  };
  reader.readAsDataURL(file);
});

CanvasRenderingContext2D.prototype.roundRect = function(x,y,w,h,r){
  if(w<2*r) r=w/2; if(h<2*r) r=h/2;
  this.beginPath();
  this.moveTo(x+r, y);
  this.arcTo(x+w, y, x+w, y+h, r);
  this.arcTo(x+w, y+h, x, y+h, r);
  this.arcTo(x, y+h, x, y, r);
  this.arcTo(x, y, x+w, y, r);
  this.closePath();
  return this;
};

function drawOverlay(){
  const w=800,h=600;
  canvas.width=w; canvas.height=h;
  ctx.fillStyle="#fff"; ctx.fillRect(0,0,w,h);
  if(imgLoaded) ctx.drawImage(img,0,0,w,h);

  ctx.fillStyle="rgba(0,0,0,0.6)";
  ctx.roundRect(10,10,w-20,150,12).fill();

  ctx.fillStyle="#fff";
  ctx.font="bold 20px sans-serif";
  ctx.fillText("BÁO GIÁ",20,25);
  ctx.font="16px sans-serif";
  ctx.fillText("HOA LAN HỒ ĐIỆP DŨNG TRANG - ĐÀ LẠT",20,50);

  ctx.font="14px sans-serif";
  const lines=[
    `Tên sản phẩm: ${productName.value}`,
    `Kích thước: ${sizeInput.value}`,
    `Số lượng: ${qtyInput.value}`,
    `Giá: ${priceInput.value}`,
    `ĐT: ${phoneInput.value}`
  ];
  let y0=80;
  lines.forEach(l=>{
    ctx.fillText(l,20,y0);
    y0+=25;
  });
}

// Nút tạo ảnh
document.getElementById("renderBtn").addEventListener("click", drawOverlay);

// Nút tải ảnh
document.getElementById("downloadBtn").addEventListener("click", ()=>{
  drawOverlay();
  const a=document.createElement("a");
  a.href=canvas.toDataURL("image/png");
  a.download="baogia.png";
  a.click();
});

// Nút chia sẻ
document.getElementById("shareBtn").addEventListener("click", async ()=>{
  drawOverlay();
  canvas.toBlob(async blob=>{
    const file = new File([blob], "baogia.png", {type:"image/png"});
    if(navigator.canShare && navigator.canShare({files:[file]})){
      try{
        await navigator.share({
          files:[file],
          title:"Báo giá hoa lan",
          text:"Báo giá hoa lan từ HOA LAN HỒ ĐIỆP DŨNG TRANG - ĐÀ LẠT"
        });
      } catch(err){
        alert("Chia sẻ thất bại: "+err);
      }
    } else {
      const a=document.createElement("a");
      a.href=URL.createObjectURL(blob);
      a.download="baogia.png";
      a.click();
      alert("Trình duyệt không hỗ trợ chia sẻ trực tiếp. Ảnh đã tải về.");
    }
  });
});
</script>
</body>
</html>
