<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Thư viện ảnh GitHub</title>
<style>
  body { font-family: Arial; background:#fafafa; padding:20px; }
  h2 { text-align:center; margin-top:0; }
  #folders { text-align:center; margin-bottom:20px; }
  select { padding:10px; font-size:16px; margin:5px; }
  .album-title { text-align:center; margin:30px 0 10px; font-weight:bold; font-size:18px; }
  .gallery { display:flex; flex-wrap:wrap; gap:15px; justify-content:center; }
  .gallery img {
    width:220px; border-radius:8px;
    box-shadow:0 4px 12px rgba(0,0,0,0.2);
    transition:0.2s;
    cursor:pointer;
  }
  .gallery img:hover { transform:scale(1.05); }

  /* Lightbox */
  #lightbox { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); display:none; justify-content:center; align-items:center; z-index:9999; flex-direction:column; }
  #lightbox img { max-width:90%; max-height:80%; border-radius:8px; margin-bottom:15px; }
  #lightbox button { padding:10px 20px; font-size:16px; cursor:pointer; border:none; border-radius:5px; background:#fff; }
</style>
</head>
<body>

<h2>THƯ VIỆN ẢNH</h2>

<div id="folders">
  <label>Chọn album: </label>
  <select id="folderSelect">
    <option value="all">Tất cả album</option>
  </select>
</div>

<div id="gallery"></div>

<!-- Lightbox -->
<div id="lightbox">
  <img id="lightbox-img" src="">
  <button onclick="closeLightbox()">Đóng</button>
</div>

<script>
const USERNAME = "ductrong49";
const REPO = "dungtrang_orchid";
const repoAPI = `https://api.github.com/repos/${USERNAME}/${REPO}/contents`;

// Map tên hiển thị album (tiếng Việt) -> tên thư mục repo
const albumsMap = {
  "Mẫu Hoa": "MauHoa",
  "Lan": "Lan"
};

let allFolders = Object.keys(albumsMap);
let currentFolder = "all";

// Load danh sách album vào dropdown
function loadAlbumSelect() {
  const select = document.getElementById("folderSelect");
  allFolders.forEach(name => {
    const opt = document.createElement("option");
    opt.value = albumsMap[name];
    opt.textContent = name;
    select.appendChild(opt);
  });

  select.addEventListener("change", () => {
    const val = select.value;
    if (val === "all") loadImages("all");
    else loadImages(val);
  });
}

// Load ảnh theo album
async function loadImages(folder) {
  const galleryDiv = document.getElementById("gallery");
  galleryDiv.innerHTML = "";

  // Nếu folder = "all" -> load tất cả album, phân biệt từng nhóm
  if (folder === "all") {
    for (const [displayName, repoName] of Object.entries(albumsMap)) {
      // Thêm tiêu đề album
      const title = document.createElement("div");
      title.className = "album-title";
      title.textContent = displayName;
      galleryDiv.appendChild(title);

      const res = await fetch(`${repoAPI}/${repoName}`);
      const files = await res.json();
      const images = files.filter(f => /\.(jpg|jpeg|png|gif|webp)$/i.test(f.name))
                          .map(f => f.download_url);

      const albumGallery = document.createElement("div");
      albumGallery.className = "gallery";

      images.forEach(url => {
        const img = document.createElement("img");
        img.src = url;
        img.onclick = () => openLightbox(url);
        albumGallery.appendChild(img);
      });

      galleryDiv.appendChild(albumGallery);
    }
  } else {
    // Load ảnh album riêng
    const displayName = Object.keys(albumsMap).find(key => albumsMap[key] === folder);
    const title = document.createElement("div");
    title.className = "album-title";
    title.textContent = displayName;
    galleryDiv.appendChild(title);

    const res = await fetch(`${repoAPI}/${folder}`);
    const files = await res.json();
    const images = files.filter(f => /\.(jpg|jpeg|png|gif|webp)$/i.test(f.name))
                        .map(f => f.download_url);

    const albumGallery = document.createElement("div");
    albumGallery.className = "gallery";
    images.forEach(url => {
      const img = document.createElement("img");
      img.src = url;
      img.onclick = () => openLightbox(url);
      albumGallery.appendChild(img);
    });

    galleryDiv.appendChild(albumGallery);
  }
}

// Lightbox
function openLightbox(url) {
  document.getElementById("lightbox-img").src = url;
  document.getElementById("lightbox").style.display = "flex";
}
function closeLightbox() {
  document.getElementById("lightbox").style.display = "none";
}

// Khởi tạo
loadAlbumSelect();
loadImages("all");
</script>

</body>
</html>
